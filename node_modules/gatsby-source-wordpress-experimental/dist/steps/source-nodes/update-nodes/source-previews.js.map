{"version":3,"sources":["../../../../src/steps/source-nodes/update-nodes/source-previews.js"],"names":["sourcePreviews","webhookBody","reporter","url","preview","previewId","token","remoteUrl","hostname","settingsHostname","urlUtil","parse","remoteHostname","panic","chalk","bold","actionType"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEO,MAAMA,cAAc,GAAG,OAAO;AAAEC,EAAAA,WAAF;AAAeC,EAAAA;AAAf,CAAP,EAAkC;AAAEC,EAAAA;AAAF,CAAlC,KAA8C;AAC1E,MACE,CAACF,WAAD,IACA,CAACA,WAAW,CAACG,OADb,IAEA,CAACH,WAAW,CAACI,SAFb,IAGA,CAACJ,WAAW,CAACK,KAHb,IAIA,CAACL,WAAW,CAACM,SALf,EAME;AACA;AACD;;AAED,QAAM;AAAEC,IAAAA,QAAQ,EAAEC;AAAZ,MAAiCC,aAAQC,KAAR,CAAcR,GAAd,CAAvC;;AACA,QAAM;AAAEK,IAAAA,QAAQ,EAAEI;AAAZ,MAA+BF,aAAQC,KAAR,CAAcV,WAAW,CAACM,SAA1B,CAArC;;AAEA,MAAIE,gBAAgB,KAAKG,cAAzB,EAAyC;AACvCV,IAAAA,QAAQ,CAACW,KAAT,CACE,wCACG,oGAAmGC,eAAMC,IAAN,CACjG,aADiG,CAElG,IAAGd,WAAW,CAACM,SAAU,MAAKO,eAAMC,IAAN,CAC7B,qBAD6B,CAE9B,IAAGZ,GAAI,EALX,CADF;AASD;;AAED,QAAM;AACJa,IAAAA,UAAU,EAAG;AADT,KAEDf,WAFC,EAAN;AAID,CA9BM","sourcesContent":["import { fetchAndCreateSingleNode } from \"~/steps/source-nodes/update-nodes/wp-actions/update\"\nimport { formatLogMessage } from \"~/utils/format-log-message\"\nimport chalk from \"chalk\"\nimport urlUtil from \"url\"\n\nexport const sourcePreviews = async ({ webhookBody, reporter }, { url }) => {\n  if (\n    !webhookBody ||\n    !webhookBody.preview ||\n    !webhookBody.previewId ||\n    !webhookBody.token ||\n    !webhookBody.remoteUrl\n  ) {\n    return\n  }\n\n  const { hostname: settingsHostname } = urlUtil.parse(url)\n  const { hostname: remoteHostname } = urlUtil.parse(webhookBody.remoteUrl)\n\n  if (settingsHostname !== remoteHostname) {\n    reporter.panic(\n      formatLogMessage(\n        `Received preview data from a different remote URL than the one specified in plugin options. \\n\\n ${chalk.bold(\n          `Remote URL:`\n        )} ${webhookBody.remoteUrl}\\n ${chalk.bold(\n          `Plugin options URL:`\n        )} ${url}`\n      )\n    )\n  }\n\n  await fetchAndCreateSingleNode({\n    actionType: `PREVIEW`,\n    ...webhookBody,\n  })\n}\n"],"file":"source-previews.js"}